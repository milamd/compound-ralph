# Ralph Orchestrator Configuration for Claude
# v2 nested format - optimized for Claude Code CLI

# Event loop settings
event_loop:
  prompt_file: "PROMPT.md"
  completion_promise: "LOOP_COMPLETE"
  max_iterations: 100
  max_runtime_seconds: 14400      # 4 hours
  max_consecutive_failures: 5
  checkpoint_interval: 5

# CLI backend settings
cli:
  backend: "kiro"
  prompt_mode: "arg"              # Pass prompt as CLI argument
  pty_mode: false                 # Set true for rich terminal UI
  pty_interactive: true           # Forward keystrokes in PTY mode
  idle_timeout_secs: 30           # Kill after 30s of inactivity

# Core behaviors (always injected into prompts)
core:
  scratchpad: ".agent/scratchpad.md"
  specs_dir: "./specs/"
  guardrails:
    - "Fresh context each iteration - scratchpad is memory"
    - "Don't assume 'not implemented' - search first"
    - "Backpressure is law - tests/typecheck/lint must pass"

# Default hats: planner and builder
# These are registered automatically if no custom hats are defined.
# Uncomment and modify to customize or add additional hats.
#
# hats:
#   planner:
#     name: "Planner"
#     triggers: ["task.start", "build.done", "build.blocked"]
#     publishes: ["build.task"]
#     instructions: ""            # Empty = use default rich prompt
#
#   builder:
#     name: "Builder"
#     triggers: ["build.task"]
#     publishes: ["build.done", "build.blocked"]
#     instructions: ""            # Empty = use default rich prompt
#
#   # Example: Add a reviewer hat
#   reviewer:
#     name: "Reviewer"
#     triggers: ["review.request"]
#     publishes: ["review.done", "review.rejected"]
#     instructions: |
#       Review the implementation for correctness, style, and security.
#       If good: publish review.done
#       If problems: publish review.rejected with specific feedback

# Feature flags
git_checkpoint: true
verbose: false
